<!DOCTYPE html><html lang="zh-CN" class="astro-T6W5MSP6">
  <head>
    <!-- Global Metadata --><meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<link rel="shortcut icon" href="/favicon.ico">
<meta name="generator" content="Astro v1.1.3">

<!-- Primary Meta Tags -->
<title>SQL 语句中 where=1 的作用</title>
<meta name="title" content="SQL 语句中 where=1 的作用">
<meta name="description" content="Lorem ipsum dolor sit amet">

<!-- Open Graph / Facebook -->
<meta property="og:type" content="website">
<meta property="og:url" content="https://langiu.github.io/posts/inasd/">
<meta property="og:title" content="SQL 语句中 where=1 的作用">
<meta property="og:description" content="Lorem ipsum dolor sit amet">
<meta property="og:image" content="https://langiu.github.io/placeholder-social.jpg">

<!-- Twitter -->
<meta property="twitter:card" content="summary_large_image">
<meta property="twitter:url" content="https://langiu.github.io/posts/inasd/">
<meta property="twitter:title" content="SQL 语句中 where=1 的作用">
<meta property="twitter:description" content="Lorem ipsum dolor sit amet">
<meta property="twitter:image" content="https://langiu.github.io/placeholder-social.jpg">

    
  <link rel="stylesheet" href="/assets/e4500743.84e0f68c.css" />
<link rel="stylesheet" href="/assets/6b91d953.2d77ac45.css" />
<link rel="stylesheet" href="/assets/4eb31de3.7a9c934a.css" /></head>
  <body class="astro-T6W5MSP6">
    <aside class="sider astro-QLDQO2WK">
  <div class="header astro-QLDQO2WK">
    <img class="avatar astro-QLDQO2WK" src="../../eye.jpg" alt="Avatar">
    <p class="description astro-QLDQO2WK">刘浪的博客</p>
  </div>
  <div class="astro-QLDQO2WK">
    <a class="nav astro-QLDQO2WK" href="/">首页</a>
    <a class="nav astro-QLDQO2WK" href="/tags">标签</a>
    <a class="nav astro-QLDQO2WK" href="/about">关于</a>
  </div>
</aside>


    <main class="astro-T6W5MSP6">
      <div class="content astro-T6W5MSP6">
        <div class="article-wrapper astro-T6W5MSP6">
          <article class="astro-T6W5MSP6">
            <h1 class="title astro-T6W5MSP6">SQL 语句中 where=1 的作用</h1>
            <time class="astro-T6W5MSP6">
                  2022年2月28日
                </time>
            <div class="astro-T6W5MSP6">
              <span class="tag astro-VPXDGWUV" style="--backgroundColor: #576;">SQL</span>


            </div>
            <hr class="astro-T6W5MSP6">
            <img class="hero astro-T6W5MSP6" width="100%" height="360" src="/sql-where.jpg" alt="">
            
            <h2 id="背景">背景</h2>
<p>最近接手了一个 NodeJS 的老项目，这个项目是 2017 年开始做的，没有用到像现在我们常用的 Prisma、TypeORM 或 Sequelize 这类 ORM 框架，是使用的原生的 T-SQL 语句进行查询，在熟悉代码的时候看到查询后有 <code>WHERE 1=1</code> 这段代码，感觉很疑惑不是很清楚这段代码在实际查询中有和意义，因为 <code>WHERE 1=1</code> 是永远为 <code>true</code>，应该起不到过滤查询的作用。难道它有我所不知道的用途？</p>
<h2 id="where-11-是否改善了查询执行">WHERE 1=1 是否改善了查询执行？</h2>
<p>为了验证这个问题，我在数据库中进行了查询测试，结果发现无论加不加 <code>WHERE 1=1</code> ，查询所需的时间都是一致的，那说明 <code>WHERE 1=1</code> 并没有查询速度，那么为什么有这条语句呢？</p>
<h2 id="方便后续-sql-查询语句的拼接">方便后续 SQL 查询语句的拼接</h2>
<p>继续研究代码后发现，往往这条语句后都伴随着些许条件查询，那么只有一种可能，这句语句就是单纯的为了方便 SQL 查询语句的拼接而诞生的。</p>
<p>因为后续的查询条件根据用户的实际操作可能会有一个或多个条件，当然也可能一个条件也没有，那么这时候只需要在这条 SQL 语句后根据传入的条件拼接 <code>AND A=&#39;%as%&#39;</code> 之类的语句即可，而不需要再单独判断是否有查询条件。\</p>
<pre class="astro-code" style="background-color:#282A36;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word"><code><span class="line"><span style="color:#F8F8F2">stmt  </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> </span><span style="color:#E9F284">&quot;</span><span style="color:#F1FA8C">SELECT * </span><span style="color:#E9F284">&quot;</span></span>
<span class="line"><span style="color:#F8F8F2">stmt </span><span style="color:#FF79C6">+=</span><span style="color:#F8F8F2"> </span><span style="color:#E9F284">&quot;</span><span style="color:#F1FA8C">FROM TABLE </span><span style="color:#E9F284">&quot;</span></span>
<span class="line"><span style="color:#F8F8F2">stmt </span><span style="color:#FF79C6">+=</span><span style="color:#F8F8F2"> </span><span style="color:#E9F284">&quot;</span><span style="color:#F1FA8C">WHERE 1=1 </span><span style="color:#E9F284">&quot;</span></span>
<span class="line"><span style="color:#FF79C6">if</span><span style="color:#F8F8F2"> user chooses </span><span style="color:#FF79C6">option</span><span style="color:#F8F8F2"> a </span><span style="color:#FF79C6">then</span><span style="color:#F8F8F2"> stmt </span><span style="color:#FF79C6">+=</span><span style="color:#F8F8F2"> </span><span style="color:#E9F284">&quot;</span><span style="color:#F1FA8C">and A is not null </span><span style="color:#E9F284">&quot;</span></span>
<span class="line"><span style="color:#FF79C6">if</span><span style="color:#F8F8F2"> user chooses </span><span style="color:#FF79C6">option</span><span style="color:#F8F8F2"> b </span><span style="color:#FF79C6">then</span><span style="color:#F8F8F2"> stmt </span><span style="color:#FF79C6">+=</span><span style="color:#F8F8F2"> </span><span style="color:#E9F284">&quot;</span><span style="color:#F1FA8C">and B is not null </span><span style="color:#E9F284">&quot;</span></span>
<span class="line"><span style="color:#FF79C6">if</span><span style="color:#F8F8F2"> user chooses </span><span style="color:#FF79C6">option</span><span style="color:#F8F8F2"> b </span><span style="color:#FF79C6">then</span><span style="color:#F8F8F2"> stmt </span><span style="color:#FF79C6">+=</span><span style="color:#F8F8F2"> </span><span style="color:#E9F284">&quot;</span><span style="color:#F1FA8C">and C is not null </span><span style="color:#E9F284">&quot;</span></span>
<span class="line"><span style="color:#FF79C6">if</span><span style="color:#F8F8F2"> user chooses </span><span style="color:#FF79C6">option</span><span style="color:#F8F8F2"> b </span><span style="color:#FF79C6">then</span><span style="color:#F8F8F2"> stmt </span><span style="color:#FF79C6">+=</span><span style="color:#F8F8F2"> </span><span style="color:#E9F284">&quot;</span><span style="color:#F1FA8C">and D is not null </span><span style="color:#E9F284">&quot;</span></span></code></pre>
          </article>
        </div>
        <div class="catalogue astro-T6W5MSP6">
          <h2 class="heading astro-T6W5MSP6">目录</h2>
          <ul class="astro-T6W5MSP6">
            <li class="header-link depth-2 astro-T6W5MSP6">
                    <a href="#背景" class="astro-T6W5MSP6">背景</a>
                  </li><li class="header-link depth-2 astro-T6W5MSP6">
                    <a href="#where-11-是否改善了查询执行" class="astro-T6W5MSP6">WHERE 1=1 是否改善了查询执行？</a>
                  </li><li class="header-link depth-2 astro-T6W5MSP6">
                    <a href="#方便后续-sql-查询语句的拼接" class="astro-T6W5MSP6">方便后续 SQL 查询语句的拼接</a>
                  </li>
          </ul>
        </div>
      </div>
      <footer class="astro-ROSMR3ZC">
  &copy; 2022 langliu. All rights reserved.
</footer>

    </main>
  </body></html>