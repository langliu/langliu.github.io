---
import { CollectionEntry, getCollection } from 'astro:content'
import CoustomLayout from '@layouts/CoustomLayout.astro'
import Blog from '@components/Blog.astro'

type Props = CollectionEntry<'blog'>

export async function getStaticPaths() {
  let tags: string[] = []
  const posts = await getCollection('blog')
  posts.forEach((post) => {
    tags = [...tags, ...post.data.tags]
  })
  tags = [...new Set(tags)]
  return tags.map((tag) => ({ params: { tag } }))
}

const { tag } = Astro.props
---

<CoustomLayout>
  <Blog tag={tag} />
</CoustomLayout>
