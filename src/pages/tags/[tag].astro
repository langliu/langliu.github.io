---
import CoustomLayout from '@layouts/CoustomLayout.astro'
import Blog from '@components/Blog.astro'
type Props = {
  /** 标签名称 */
  tag: string
}

export async function getStaticPaths() {
  let tags: string[] = []
  const posts = (await Astro.glob('../../pages/posts/**/*.{md,mdx}')).sort(
    (a, b) => new Date(b.frontmatter.pubDate).valueOf() - new Date(a.frontmatter.pubDate).valueOf()
  )

  posts.forEach((post) => {
    tags = [...tags, ...post.frontmatter.tags]
  })
  tags = [...new Set(tags)]
  return tags.map((tag) => ({ params: { tag } }))
}

const { tag } = Astro.params as Props
---

<CoustomLayout>
  <Blog tag={tag} />
</CoustomLayout>
